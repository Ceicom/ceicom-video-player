"use strict";function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){_defineProperty(e,t,n[t])})}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this._player={},this._videos=t,this._options=n,this._actualVideo=0,this._isPlaying=!1,this._fakePlayer=$(".cvp-player"),this._$playBtn=this._fakePlayer.find(".play-btn"),this._$progressBar=this._fakePlayer.find(".progress-bar"),this._$time=this._fakePlayer.find(".time"),this._$volumeWrapper=this._fakePlayer.find(".volume-wrapper"),this._$volumeInput=this._fakePlayer.find(".volume-input"),this._$expandBtn=this._fakePlayer.find(".expand-button"),this.init()}return _createClass(e,[{key:"init",value:function(){var e=this;if(this._videos.length){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.src="https://www.youtube.com/iframe_api",n.parentNode.insertBefore(t,n),window.onYouTubeIframeAPIReady=function(){var t=_objectSpread({width:600,height:600,playerVars:{autoplay:0,cc_load_policy:0,controls:0,disablekb:1,enablejsapi:1,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0},events:{onReady:a,onStateChange:r,onError:l}},e._options);e._player=new YT.Player("cvp-player",t),e._initFakePlayerActions()};var a=function(){var t=e._videos.map(function(t){return e._validaYoutube(t.link)});e._player.loadPlaylist(t),e._player.setLoop(!0),e._isPlaying=!0,setInterval(function(){e._updateTime(e._player.getCurrentTime(),e._player.getDuration()),e._updateProgressBar(e._player.getCurrentTime(),e._player.getDuration())},1e3)},r=function(t){e._isPlaying=!0,e._fakePlayer.addClass("playing"),2===t.data&&(e._isPlaying=!1,e._fakePlayer.removeClass("playing")),e._player.getPlaylistIndex()!==e._actualVideo&&(e._actualVideo=e._player.getPlaylistIndex(),e._videoChange())},l=function(){e._videoChange(!0),e._player.nextVideo()}}else $(this._fakePlayer).html('<span class="error-msg">Nenhuma m√∫sica detectada na lista atual.</span>')}},{key:"_initFakePlayerActions",value:function(){var e=this;this._$playBtn.on("click",function(){return e._isPlaying?e._player.pauseVideo():e._player.playVideo()}),this._$volumeWrapper.on("click",function(t){$(t.target).hasClass("volume-wrapper")&&e._$volumeWrapper.toggleClass("active")}),this._$volumeInput.on("input",function(){return e.setVolume(e._$volumeInput.val()/10)}),this._$expandBtn.on("click",function(){var t=e._fakePlayer.parent()[0];document.fullscreen||document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():t.webkitExitFullscreen&&document.webkitExitFullscreen():t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()})}},{key:"getVolume",value:function(){return this._player.getVolume()}},{key:"setVolume",value:function(e){this._player.setVolume(100*e)}},{key:"_validaYoutube",value:function(e){var t=/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/g.exec(e);return!(!t||11!==t[1].length)&&t[1]}},{key:"_videoChange",value:function(e){$(document).trigger("cmp-media-end",[this._player.getPlaylistIndex(),e])}},{key:"_updateProgressBar",value:function(e,t){this._$progressBar.css("transform","scaleX(".concat(Math.ceil(e)/Math.ceil(t),")"))}},{key:"_updateTime",value:function(e,t){var n=function(e){return e<10?"0"+e:e},a=function(e){var t=parseInt(Math.ceil(e)%60),a=parseInt(Math.ceil(e)/60%60);return n(a)+":"+n(t)};this._$time.text(a(e)+" / "+a(t))}}]),e}();"undefined"!=typeof exports?exports.CeicomVideoPlayer=e:window.CeicomVideoPlayer=e}("undefined"!=typeof global&&global);